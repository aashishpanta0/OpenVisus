<VirtualHost *:80>

  ServerAdmin scrgiorgio@gmail.com
  DocumentRoot /usr/local/apache2/htdocs
  
  Alias /viewer /home/OpenVisus/webviewer
  <Directory /home/OpenVisus/webviewer>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All
    Header set "Access-Control-Allow-Origin" "*"
    Require all granted
  </Directory> 

  <LocationMatch "/mod_visus">
    Header set "Access-Control-Allow-Origin" "*"
    SetHandler visus
    # this was required at some point but doesn't seem necessary now; leaving it here just in case
    #DirectorySlash Off
    <If "%{QUERY_STRING} =~ /.*action=AddDataset.*/ || %{QUERY_STRING} =~ /.*action=configure_datasets.*/ || %{QUERY_STRING} =~ /.*action=add_dataset.*/" >
      AuthType Basic
      AuthName "Authentication Required"
      AuthUserFile "/home/OpenVisus/.htpasswd"
      Require valid-user
    </If>
    <Else>
      Require all granted
    </Else>
  </LocationMatch>
  
  <Location /server-status>
    SetHandler server-status
    Order allow,deny
    Allow from all
    </Location>

</VirtualHost>
